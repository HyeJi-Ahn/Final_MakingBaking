<!DOCTYPE html>
<html lang="ko"
	  xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="~{layouts/layout}">
	  
	<!-- head 영역 시작 -->
	<!-- 개별적으로 사용할 css, js 링크를 걸기 위해서 남겨둠 -->
	<head>
		<th:block layout:fragment="css">
		<link rel="stylesheet" th:href="@{/css/item.css}">
		</th:block>
		
		<th:block layout:fragment="script">
		<script th:inline="javascript" th:src="@{/js/jquery-ui.min.js}"></script>
			<script th:inline="javascript">
				$(function() {
					// 취소환불 문의 자세히 보기
					$(".refundGuideBtn").on("click", function(){
						if($("#refundGuide").css("display") == "none") {
							$("#refundGuide").css("display", "block");	
							$(".refundGuideBtn").text("자세히 보기 ▲");	
						} else {
							$("#refundGuide").css("display", "none");
							$(".refundGuideBtn").text("자세히 보기 ▼");	
						}
						
					});
					
					$(".cancelGuideBtn").on("click", function(){
						if($("#cancelGuide").css("display") == "none") {
							$("#cancelGuide").css("display", "block");		
							$(".cancelGuideBtn").text("자세히 보기 ▲");						
						} else {
							$("#cancelGuide").css("display", "none");
							$(".cancelGuideBtn").text("자세히 보기 ▼");	
						}
						
					});
					
					// 비회원이 바로구매 클릭시 로그인 창 띄우기
					$("#itemGetBtn").on("click", function() {
						const isAuthenticated = $(".header > input[name='authenticate']").val();
						if(isAuthenticated == "false") {
							$('.login-form-container').toggleClass('active');
							
						} 
						if(confirm("상품 수량 : " + $("#itemNm_cnt").val() +"개를 구매하시겠습니까?" )) {						
								
						$("#itemForm").submit();
						} else {
							alert("취소되었습니다.");
							return;
						}
					});
					
					// 비회원이 장바구니 클릭시
					$("#itemCartBtn").on("click", function() {
						let cartClick = false;
						
						const isAuthenticated = $(".header > input[name='authenticate']").val();
						if(isAuthenticated == "false") {
							$('.login-form-container').toggleClass('active');
						
						}
						
						if(!cartClick) {
							$.ajax({
								url: '/cart/orderCartList',
								type: 'post',
								data: { itemNo },
								success: function(obj) {
									console.log(obj);
									cartClick = true;
								}, error: function(e) {
									console.log(e);
								}
							});							
						} else {
							alert("장바구니는 1초에 한 번씩 클릭 가능합니다.");	
							console.log('noclick');
							setTimeout(function() {
								cartClick = false;
							}, 1000);
						}
					
					});
					
					// 비회원이 좋아요 클릭시 로그인 창 띄우기
					$("#itemLikeBtn").on("click", function() {
						const isAuthenticated = $(".header > input[name='authenticate']").val();
						if(isAuthenticated == "false") {
							$('.login-form-container').toggleClass('active');
						
						}
					});
					

					
				});
			</script>
		</th:block>
	</head>
	<!-- head 영역 끝 -->
	<body>
	<div layout:fragment="content">
	  <div class="entire-wrap" >	  
	  <div class="item">
	    <main > 
	      <section class="it_banner"> 
	        <div class="it_banner_container">
	          <div class="it_banner">
				<form id="itemForm" action="/cart/orderCartList" method="post">	          
		            <div class="itbanner_mainImg">
		              <img class="itbanner_main_img" th:src="@{/images/class_main.jpg}"
		              width="350px">
		            </div>
		            <div class="itbanner_explain">        
		              <h2 th:text="${item.itemName}">타이틀 ${item.dayclassTitle }</h2>
		              <div class="itbanner_explain_sTitle">
		              <p>영양 정보</p>
		              </div>
		              <div class="itbanner_explain_KRW">
		                <span>KRW ${}</span>
		              </div> 
	             </form>
	              <div class="itbanner_explain_details">
	                <span>&ensp;&ensp;</span>  
	                <span>&ensp;3시간&ensp;</span>
	                <span>서울/강남${} </span>
	              </div>
	              <div class="itbanner_explain_btn">	             
	                <span><button type="button" id="itemGetBtn" value="itemGet">바로구매  
	                </button></span>
	          		<span><button type="button" id="itemCartBtn" value="itemCart">장바구니  
	                </button></span>
	                <span><button type="button" id="itemLikeBtn" th:value="@{itemLike}">♡
	                </button></span>

	              </div>
	            </div>  
	          </div>
	        </div>
	      </section>
	      <section class="it_menu">
	        <div class="itmenu">
	          <ul >
	            <li><a th:href="@{#itemIntro}" 
	              class="m_intro_a">상품설명</a></li>
	            <li><a th:href="@{#dayclass_hr2}" 
	              class="m_apply_a">상세정보</a></li>
	            <li><a th:href="@{#dayclass_hr1}" 
	              class="m_rvw_a">후기${rvwCnt }</a></li>
	            <li><a th:href="@{#dayclass_hr3}" 
	              class="m_cancel_a">취소/환불</a></li>
	          </ul>
	        </div>    
	      </section>
	      <section class="it_contents">
	        <div class="it_contents_container">
	          <div class="it_contents">
	            <div class="it_cintro" id="itemIntro" >
	              <h3 class="it_cintro_title">상품설명</h3>
	              <p class="it_cintro_text"></p>
	            </div>
	            <hr class="item_hr">
	            <div class="it_cDetatils" id="itemDetails">
	              <h3 class="it_cDetatils_title">상세정보</h3>
	              <p class="it_cDetatils_text">
	              	${lctr.lctrDetails } 상품 상세 정보(영양정보)
	              	국회의원은 법률이 정하는 직을 겸할 수 없다. 중앙선거관리위원회는 법령의 범위안에서 선거관리·국
	                민투표관리 또는 정당사무에 관한 규칙을 제정할 수 있으며, 법률에 저촉되지 아니하는 범위안에서 내
	                부규율에 관한 규칙을 제정할 수 있다.              
	                국무총리는 국회의 동의를 얻어 대통령이 임명한다. 헌법개정안이 제2항의 찬성을 얻은 때에는 헌법개 
	                정은 확정되며, 대통령은 즉시 이를 공포하여야 한다.
	                위원은 정당에 가입하거나 정치에 관여할 수 없다. 여자의 근로는 특별한 보호를 받으며, 고용·임금 
	                및 근로조건에 있어서 부당한 차별을 받지 아니한다.
	                행정권은 대통령을 수반으로 하는 정부에 속한다. 대한민국의 경제질서는 개인과 기업의 경제상의 자
	                유와 창의를 존중함을 기본으로 한다. 대통령은 법률에서 구체적으로 범위를 정하여 위임받은 사항과 
	                법률을 집행하기 위하여 필요한 사항에 관하여 대통령령을 발할 수 있다.
	              </p>
	            </div>
	            <hr id="item_hr">
	            <div class="it_rvw" id="itemReview">
	              <h3 class="it_rvw_title" >상품후기</h3>
	              <div class="it_rvw_write">
	              	<div class="it_rvw_write_member">
	              		<form class="it_rvw_write_form" method="post" action="" >
	              			<p>
	              			작성자<input type="hidden" name="writerId" id="writerId" value="${loginUser.userId }">
	              			</p>
	              			<fieldset>
							<input type="radio" name="reviewStar" value="5" id="rate1"><label
								for="rate1">★</label>
							<input type="radio" name="reviewStar" value="4" id="rate2"><label
								for="rate2">★</label>
							<input type="radio" name="reviewStar" value="3" id="rate3"><label
								for="rate3">★</label>
							<input type="radio" name="reviewStar" value="2" id="rate4"><label
								for="rate4">★</label>
							<input type="radio" name="reviewStar" value="1" id="rate5"><label
								for="rate5">★</label>
							</fieldset>
							<p>
	              				<textarea placeholder=" 로그인 후 상품 및 클래스 후기를 작성해주세요."></textarea>
	              			</p>
	              			<div class=""> 
	              			<button class="it_rvw_writeBtn" type="submit">등록</button>
	              			</div>
	              		</form>
	              	</div>
	                <div class="it_rvw_wirte_detail">
	                  <div class="it_rvw_option"> 
	                    <select name="it_rvw_array" id="it_rvw_array">
	                      <option>평점순</option>
	                      <option>최신순</option>
	                      <option>오래된순</option>
	                    </select>
	                  </div>
	                  <span>
	                    <table class="it_rvw_list">
	                      <colgroup>
	                        <col width="140">
	                        <col width="">
	                        <col width="130">
	                        <col width="120">
	                      </colgroup>
	                      <thead>
	                        <tr>
	                          <th scope="col">평점</th>
	                          <th scope="col">내용</th>
	                          <th scope="col">작성일자</th>
	                          <th scope="col">작성자</th>
	                        </tr>
	                      </thead>
	                      <tbody>
	                    
	                      	<tr th:each="review : ${pageReviewList}">
	                          <td>
	                          	<span th:each="num : ${#numbers.sequence(1, review.rvwScore)}">⭐</span>
                          	  </td>
	                          <td th:text="${review.rvwContent}"></td>
	                          <td th:text="${review.rvwRegdate eq null ? '' : #strings.substring(review.rvwRegdate, 0, 10)}"></td>
	                          <td sec:authorize="hasRole('ROLE_ADMIN')" th:text="${review.rvwWriter}"></td>
	                          <td sec:authorize="!hasRole('ROLE_ADMIN')" th:text="${review.rvwWriter.substring(0, review.rvwWriter.length()-3) + '***'}"></td>
	                        </tr> 
	                      </tbody>
	                    </table>
	                    <div class="it_rvw_pasing">
	                    
	                      <ul class="paging" style="display: flex; justify-content: center;" 
							th:if="${pageReviewList.totalElements > 0}"
							th:with="pageNumber = ${pageReviewList.pageable.pageNumber},
												pageSize = ${pageReviewList.pageable.pageSize},
												totalPages = ${pageReviewList.totalPages},
												startPage =${T(java.lang.Math).floor(pageNumber / pageSize) * pageSize + 1},
												tempEndPage = ${startPage + pageSize -1}, 
												endPage = ${tempEndPage > totalPages ? totalPages : tempEndPage}">
								<li class="paging_btn" th:if="${pageNumber > 0}">
									<a th:href="@{${pageNumber - 1}}">◀</a>
								</li>
								<li class="paging_btn" th:each="page : ${#numbers.sequence(startPage, endPage)}">
									<a th:href="@{${page - 1}}" th:text="${page}"></a>
								</li>
								<li class="paging_btn" th:if="${pageNumber < totalPages - 1}">
									<a th:href="@{page=${pageNumber + 1}}">▶</a>
								</li>
							</ul> 
							
	                    </div>
	                  </span>
	                </div>
	              </div>
	            </div>
	          </div>
	          <hr id="item_hr">
	          <div class="c_cancel" id="itemCancle" >
	            <h3 class="c_cancel_title">취소/환불</h3>
	            <p class="c_cancel_text_A">궁금하신 점이나 서비스 이용에 불편한 점이 있으신가요?</p>
	            <p class="c_cancel_text_B">문제가 되는 부분을 사진을 찍어 아래 중 편하신 방법으로 접수해 주시면 
	              빠르게 도와드리겠습니다.</p>
	          </div>
	          <div class="c_Qna">
	            <ul style="padding-left: 0;">
	              <li>
	                <strong>| 전화 문의</strong>
	                <p class="c_Qna_text_A">
	                  월~금요일 오전 9시 - 오후 6시<br>
	                  주말/공휴일 오전 9시 - 오후 3시
	                </p>
	              </li>
	              <li>
	                <strong>| 홈페이지 문의</strong>
	                <p class="c_Qna_text_B">
	                  365일<br>
	                  로그인 > 마이페이지 > 1:1 문의
	                </p>
	                <p class="c_Qna_text_C">
	                  고객센터 운영 시간에 순차적으로 답변해드리겠습니다.
	                </p>
	              </li>
	            </ul>
	          </div>
	          <div class="c_guide">
	            <div class="c_refundGuide">
	              <strong class="c_refundG_title">교환 및 환불 안내</strong>
	              <p class="c_refundG_text">교환 및 환불이 필요하신 경우 고객센터로 문의해주세요.</p>
	              <button type="button" class="refundGuideBtn">자세히 보기 ▼</button>
	            </div>
	            <div id="refundGuide">			       
		            <div class="c_refundG_01">
		              <strong class="c_refundG_01title">01. 상품에 문제가 있는 경우</strong>
		              <p class="c_refundG_01text_A">받으신 상품이 표시/광고/내용 또는 계약과 다른 경우에는 상품을 받은 날부터 1개월 이내,
		              그 사실을 알게 된 날부터 14일 이내에 교환 및 환불을 요청하실 수 있습니다.
		              
		              <span class="c_refundG_01text_B">※ 배송 상품에 문제가 있는 것으로 확인되면 배송비는 MakingBaking이 부담합니다.</span>
		              </p>
		            </div>
		            <div class="c_refundG_02">
		              <strong class="c_refundG_02title">02. 단순 변심, 주문 착오의 경우</strong>
		              <p class="c_refundG_02text">
		              	<strong class="c_refundG_02text_A">실온/냉장 식품</strong><br>
		              	재판매가 불가한 상품의 특성상, 단순변심, 주문 착오 시 교환 및 반품이 어려운 점 양해 부탁드립니다.
		              	상품에 따라 조금씩 맛이 다를 수 있으며, 개인의 기호에 따라 같은 상품도 다르게 느끼실 수 있습니다.			              	
		              	
		              	<strong class="c_refundG_02text_B">유통기한 30일 이상 식품</strong><br>
		              	상품을 받은 날부터 7일 이내 관리자에게 문의해주세요.
		              	
		              	<span>※ 단순 변심으로 인한 배송 상품 교환 또는 환불의 경우 고객님께서 배송비 6,000원을 부담하셔야 합니다.(주문건 배송비를 결제하셨을 경우 3,000원)</span>	
		              </p>
		            </div>		            
		            <div class="c_refundG_03">
		              <strong class="c_refundG_03title">03. 교환/반품이 불가한 경우</strong>
		              <p class="c_refundG_03text">
		              	다음에 해당하는 교환/환불 신청은 처리가 어려울 수 있으니 양해 부탁드립니다.
		              	<span>
		              	- 고객님의 책임 있는 사유로 상품이 멸시되거나 훼손된 경우
		              	- 고객님의 사용 또는 일부 소비로 상품의 가치가 감소한 경우
		              	- 시간이 지나 다시 판매하기 곤란할 정도로 상품의 가치가 감소한 경우
		              	- 복제가 가능한 상품의 포장이 훼손된 경우
		              	- 고객님의 주문에 따라 개별적으로 생산되는 상품의 제작이 이미 진행된 경우
		              	</span>
		              </p>
		            </div>
	            </div> 
	            <div class="c_cancelGuide">
	              <strong class="c_cancelG_title">주문 및 예약 취소 안내</strong>
	              <p class="c_cancelG_text">상품 주문 및 클래스 예약을 취소하실 수 있습니다.</p>
	              <button type="button" class="cancelGuideBtn">자세히 보기 ▼</button>
	            </div>
	            <div id="cancelGuide">
		            <div class="c_cancelG_01">
		              <strong class="c_cancelG_01title">상품 주문 취소 관련</strong>
		              <p class="c_cancelG_01text">
		              - [배송준비중] 부터는 취소가 불가하니, 반품으로 진행해주세요.
		              - 상품에 반품이 불가할 수 있습니다.
		              - 일부 예약상품은 배송 3~4일 전에만 취소 가능합니다
		              - 주문상품의 부분취소는 불가능합니다. 전체 주문 취소 후 다시 구매 해주세요.
		              </p>
		            </div>
		            <div class="c_cancelG_02">
		              <strong class="c_cancelG_02title">클래스 예약 취소 관련</strong>
		              <p class="c_cancelG_02text">
		              	<strong class="c_cancelG_02text_A">클래스 예약 취소</strong><br>
		              	- 클래스 예약 취소는, 클래스 진행 1일 전까지 취소 가능합니다.
		              	- 클래스 예약은 당일 취소가 불가합니다.
		              	
		              	<strong class="c_cancelG_02text_B">클래스 예약 환불</strong><br>
					 	- 클래스 진행 후 환불은 불가합니다.
					  	- 클래스 진행 1일 전 취소시 환불 가능하니, 고객센터에 문의해주세요.
		              </p>
		            </div>
		          </div>	
	          </div> 
	        </div>
	      </section>  
	  	</main>
	    </div>	
	  </div>
	</div>
	</body>
</html>