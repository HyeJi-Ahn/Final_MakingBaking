<!DOCTYPE html>
<html lang="ko"
	  xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="~{layouts/layout}">
<head>
	<th:block layout:fragment="script">
		<script th:inline="javascript">
				$(function(){
		      	  const itemList = /*[[${itemList}]]*/;
		      	  //console.log(itemList);
			      $("#more").click(function(e){
					  $.ajax({
						  url:"/item/list",
						  type: "post",
						  data: {
							  searchKeyword: $("#searchKeyword").val(),
							  page: $(".card").parent().length/4
						  },
						  success: function(obj) {
							  let htmlStr = "";
							  //console.log(obj.pageItems.content);
							  for(let i = 0; i < obj.pageItems.content.length; i++) {
						        htmlStr += 
						        `
						          <div>
						            <div class="card">
						              <img src="@{'/item/' + ${obj.pageItems.content[i].fileName}}" alt="NoImg" class="card_img">
						            </div>
						            <div class="text">
						              <h3><a href="{/item/item/${obj.pageItems.content[i].itemNo}}">${obj.pageItems.content[i].itemName}</a></h3>
						              <span>${obj.pageItems.content[i].itemPrice}</span><span>원</span>
						            </div>
						          </div>
						        `;
							  }
							  $("#prod").append(htmlStr);
							  
							  //console.log(obj.pageItems);
							  if(obj.pageItems.totalElements == $(".card").parent().length) {
								  $('#more').hide();
							  }
						  },
						  error: function(e) {
							  console.log(e);
						  }
					  })
			      });
			      $(document).ready(function() {
					 
					 $("#sub-navbar").click(function() {
						 let form = $("<form>").attr("action", "/item/list")
						 					   .attr("class", "sub-navbar")
						 					   .attr("method", "post").appendTo("body")
						 					   
						 let input = $("<input>").attr("name", "itemCate")
					 							 .attr("value", "빵").appendTo("body")
					 })
				  });
		    });
		    //탑버튼
		    $(window).scroll(function() {
		      if ($(this).scrollTop() > 10) {
		      	$('#topBtn').fadeIn();
		        } else {
		        $('#topBtn').fadeOut();
		      }
		     });
		     $("#topBtn").click(function() {   
		     $('html, body').animate({
		       scrollTop : 0
		      }, 10);
		      return false;
		      });
		</script>
	</th:block>
	<th:block layout:fragment="css">
			<link rel="stylesheet" th:href="@{/css/list/list.css}"/>
	</th:block>
</head>

<body>
	<div layout:fragment="content">
	  <main class="centre">
	  <!--
	    <div class="search">
	      <input type="text" id="searchKeyword" class="search-bar" placeholder="검색어 입력">
	      <a><img src="https://s3.ap-northeast-2.amazonaws.com/cdn.wecode.co.kr/icon/search.png" id="search-icon"></a>
	    </div>
	    -->
	    <nav>
		    <ul id="sub-navbar" class="sub-navbar"> 
		    	<li style="--clr:red"> 
			      <a href="#" data-text="&nbsp;All"&nbsp; value="All">&nbsp;All&nbsp;</a> 
			    </li> 
			    <li style="--clr:orange"> 
			      <a href="#" data-text="&nbsp;Bread"&nbsp; value="빵">&nbsp;Bread&nbsp;</a> 
			    </li> 
			    <li style="--clr:rgb(255,223,0);"> 
			      <a href="#" data-text="&nbsp;Cake" value="케이크">&nbsp;Cake&nbsp;</a> 
			    </li> 
			    <li style="--clr:green"> 
			      <a href="#" data-text="&nbsp;Cookie" value="쿠키">&nbsp;Cookie&nbsp;</a> 
			    </li> 
			    <li style="--clr:rgb(0, 103, 163);"> 
			      <a href="#" data-text="&nbsp;Vegan" value="비건">&nbsp;Vegan&nbsp;</a> 
			    </li> 
			    <li style="--clr:rgb(0, 0, 128);"> 
			      <a href="#" data-text="&nbsp;Dessert" value="디저트">&nbsp;Dessert&nbsp;</a> 
			    </li>
			    <li style="--clr:purple"> 
			      <a href="#" data-text="&nbsp;Etc" value="Etc">&nbsp;Etc&nbsp;</a> 
			    </li>
			</ul>
	    </nav>
	    <div id="prod">
	      <div th:each="item : ${itemList}">
	        <div class="card">
	          <img th:src="@{'/item/' + ${item.fileName}}" alt="NoImg" class="card_img">
	        </div>
	        <div class="text">
	          <h3><a th:href="@{/item/item/{itemNo} (itemNo=${item.itemNo})}" th:text="${item.itemName}"></a></h3>
	          <span th:text="${item.itemPrice}"></span><span>원</span>
	        </div>
      	  </div>
    	</div>
	    <div id="more">
	      <!-- <a href="/footer">더보기+</a> -->
	      <button type="button" id="show-more" class="show-more">더보기+</button>
	    </div>
	    <a id="topBtn" href="#">
           <img src="https://widit2.knu.ac.kr/~kiyang/teaching/IT/stPrj/happydpqhs/jam/%ED%83%91%EB%B2%84%ED%8A%BC.png"
           style="width:2.5rem; height:2.5rem">
        </a>
  		</main>
	</div>
</body>
</html>